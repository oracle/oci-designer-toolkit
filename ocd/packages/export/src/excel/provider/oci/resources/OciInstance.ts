/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/
    
import * as AutoGenerated from "./generated/OciInstance.js"
import { OciModelResources as Model } from '@ocd/model'
import { ExcelColumnProperties } from '../../../OcdExcelResource.js'
import { TableColumnProperties } from 'exceljs'

export class OciInstance extends AutoGenerated.OciInstance {
    resourceColumns = (): ExcelColumnProperties[] => {
        const columns: ExcelColumnProperties[] = [
            {header: 'Shape', key: 'shape', width: 20},
            {header: 'Memory (Gbs)', key: 'shapeConfig.memoryInGbs', width: 10},
            {header: 'OCPUs', key: 'shapeConfig.ocpus', width: 10},
            {header: 'Subnet', key: 'createVnicDetails.subnetId', width: 35},
            {header: 'NSGs', key: 'createVnicDetails.nsgIds', width: 35},
        ]
        return columns
    }
    resourceTableColumns = (): TableColumnProperties[] => {
        const columns: TableColumnProperties[] = [
            {name: 'Shape', filterButton: true},
            {name: 'Memory (Gbs)', filterButton: true, totalsRowFunction: 'sum'},
            {name: 'OCPUs', filterButton: true, totalsRowFunction: 'sum'},
            {name: 'Subnet', filterButton: true},
            {name: 'NSGs', filterButton: true},
        ]   
        return columns
    }
    resourceRowGeneration = (resource: Model.OciInstance): any[] => [
        resource.shape, 
        // @ts-ignore
        this.toNumber(resource.shapeConfig?.memoryInGbs ?? resource.shapeConfig?.memoryInGBs), // Queried resource has different name for memoryInGbs
        this.toNumber(resource.shapeConfig?.ocpus),
        this.generateReferenceAttribute(resource.createVnicDetails?.subnetId, this.allResources),
        this.generateReferenceListAttribute(resource.createVnicDetails?.nsgIds, this.allResources),
    ]
}

export default OciInstance
