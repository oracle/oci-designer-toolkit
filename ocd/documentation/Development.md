# OKIT Open Cloud Designer Development Guide

The following guide will explain how OKIT-Ocd can be extended to add additional resource and Cloud Providers. It will explain which files will need to be created/modified and how to customise the resources.
The core code used for Cloud Resources is Autogenerated as part of the build cycle and we will explain how to extend this process to both implement new resources for an existing cloud provider and add new cloud providers.

As a working example we will implement Google (GCP) as a new Cloud Provider. This will show what files need to be created and how the naming convention within the files and works.

## Naming Convention
All code generated and manual created witin the OKIT-Ocd packages must conform to the following naming standards. This allow for the simple runtime generation of Namespace names, Class names etc.

- **Interface Names**: Names must start with the provider name with an initial Capital; e.g. export interface **Google**ComputeNetwork
- **Namespace Names**: Names must start with the provider name with an initial Capital; e.g. export namespace **Google**ComputeNetwork
- **Class Names**:     Names must start with the provider name with an initial Capital; e.g. export class **Google**ComputeNetworkClient
- **File Names**:      Names must start with the provider name with an initial Capital; e.g. **Google**ComputeNetwork.ts
- **Function Names**:  Names must contain the provider name with an initial Capital; e.g. export function get**Google**Resources(design: OcdDesign)
- **Directory Names**: Names must be the provider name; e.g. **google**
- **JSON Elements**:   Names must be the provider name; e.g. **google**

## Code Generation
For new Providers and Resources a large portion of the code will be Auto Generated based on the OCD Schema derived from the providers Terraform Schema. The Provider specific functionaly and Data resources associated with code generation is split across 2 packages **codegen** and **codegen-cli** with the majority of functionality in the **codegen** package. We will walk through and describe each of the files in the following sections.

### ocd/packages/codegen
The majority of the provider specific code wraps common core generation code and simply configures the environment providing Provider specific information.

#### src/importer/GoogleTerraformSchemaImporter.ts
The &lt;Provider&gt;TerraformSchemaImporter.ts extends the common OcdTerraformSchemaImporter.ts configuring for the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;ResourceMap.ts**, **data/&lt;Provider&gt;ElementOverrides.ts**, **data/&lt;Provider&gt;ConditionalElements.ts** and **data/&lt;Provider&gt;IgnoreElements.ts**, files and passes them to the common importer.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { TerraformSchema } from "../types/TerraformSchema";
import { OcdTerraformSchemaImporter } from "./OcdTerraformSchemaImporter";
import { resourceMap, dataMap, resourceAttributes } from './data/GoogleResourceMap'
import { ignoreElements } from './data/GoogleIgnoreElements';
import { elementOverrides } from './data/GoogleElementOverrides';
import { conditionalElements } from './data/GoogleConditionalElements';

export class GoogleTerraformSchemaImporter extends OcdTerraformSchemaImporter {
    constructor() {
        super(ignoreElements, elementOverrides, conditionalElements, resourceAttributes)
        this.tfProvider = 'registry.terraform.io/hashicorp/google'
        this.provider = 'google'
    }

    convert(source_schema: TerraformSchema) {
        super.convert(source_schema, resourceMap, dataMap)
    }

}

export default GoogleTerraformSchemaImporter
// module.exports = { GoogleTerraformSchemaImporter }
```

#### src/importer/data/GoogleResourceMap.ts
The **&lt;Provider&gt;ResourceMap.ts** exports an number of constants that contain information about what resources and resource elements need to be imported from the Providers Terraform Schema. After first creation these can be updated for new elements or added to allow the creation of new resources.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdIncludedElements, OcdResourceMap } from "../../types/OcdImporterData";

export const resourceMap: OcdResourceMap = {
    "google_compute_network": "compute_network",
    "google_oracledatabase_autonomous_database_regular": "oracledatabase_autonomous_database_regular",
    "google_oracledatabase_exadata_infrastructure": "oracledatabase_exadata_infrastructure",
    "google_oracledatabase_cloud_vm_cluster": "oracledatabase_cloud_vm_cluster",
}

export const dataMap: OcdResourceMap = {}

export const resourceAttributes: OcdIncludedElements = {
    "common": [],
    "google_compute_network": [
        "gateway_ipv4"
      ],
    "google_oracledatabase_autonomous_database_regular": [],
    "google_oracledatabase_exadata_infrastructure": [],
    "google_oracledatabase_cloud_vm_cluster": [],
}
```

##### resourceMap
The resourceMap constant contains the list of Terraform Resource names that will be imported into OCD and there associated list names the will be used within the OCD Design model. For example if we want to use the Google Compute Netwotk within OCD we would add the entry:
```json
"google_compute_network": "compute_network"
```

##### dataMap
The dataMap constant contains the list of Terraform Data names that will be imported into OCD and there associated list names the will be used within the OCD Design model. For example if we want to use the Google Compute Network within OCD we would add the entry:
```json
"google_compute_network": "compute_network"
```

##### resourceAttributes
The resourceAttributes constant specifies all attributes/elements that should be created for the resource. Because the Terraform schema will list more attributes that the actually Terraform Resource consumes we need to specify which resources will be included. For example if we want to use the Google Compute Network within OCD we would add the entry:
```json
    "google_compute_network": [
        "gateway_ipv4"
      ],
```

#### src/importer/data/GoogleElementOverrides.ts
The **&lt;Provider&gt;ElementOverrides.ts** exports a single constant elementOverrides which is used to specify attribute/element specifc override information for a given resource. This is because not all information can be generated correctly from a given Terraform Schema. This includes:

- defaults: Default values for attribute
- labels: Change to the auto generated label
- required: Override the generated required flag
- lookupOverrides: Change the default generated lookup information
- lookups: Specify elements that shouls be lookups
- cacheLookups: Specify elements that should be looked up from the cached data read from the Provider, supported VM OSs for example
- staticLookups: Defines that an element is a static lookup with fixed options which will be defined in the Element Config file within the desktop package.
- types: Specifies resource elements that should have there types changed from that defined within the Terraform Schema.
- maps: Defines the valid options that a map element map contain.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdElementOverrides } from "../../types/OcdImporterData";

export const elementOverrides: OcdElementOverrides = {
    "defaults": {
        "common": {},
    },
    "labels": {
        "common": {},
    },
    "required": {
        "common": {},
    },
    "lookupOverrides": {
        "common": {},
    },
    "lookups": {
        "common": [],
    },
    "cacheLookups": {
        "common": {},
    },
    "staticLookups": {
        "common": [],
    },
    "types": {
        "common": {},
    },
    "maps": {
        "common": {},
    }
}
```

#### src/importer/data/GoogleConditionalElements.ts
The **&lt;Provider&gt;ConditionalElements.ts** exports a single constant conditionalElements which specifies conditional display rules for the properties panel. Within each Resource a list of conditional element exists that specify and list of confitions that should be tested to identify if the elements properties field will be display.

In the following example the custom_dns_servers field will only be displayed if the server_type has a value of "CustomDnsServer" and the type field has a value of "DomainNameServer".

```json
"custom_dns_servers": [
    {
        "element": "server_type",
        "operator": "eq",
        "value": "CustomDnsServer"
    },
    {
        "logic_operator": "and",
        "element": "type",
        "operator": "eq",
        "value": "DomainNameServer"
    }
]
```

Each entry is defind by the TypeScript interface:

```typescript
    export interface ResourcePropertyCondition {
        logic_operator?: 'and' | 'or'
        element?: string
        relativeToRoot?: boolean
        operator?: 'eq' | 'lt' | 'gt' | 'ne' | 'le' | 'ge' | 'in' | 'ew' | 'sw'
        value?: boolean | string | number | Function
    }
```

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdConditionalElements } from "../../types/OcdImporterData";

export const conditionalElements: OcdConditionalElements = {
    "common": {},
}
```

#### src/importer/data/GoogleIgnoreElements.ts
The **&lt;Provider&gt;ConditionalElements.ts** exports a single constant ignoreElements which defines the elements to ignore within the Terraform Schema for a given Resource. At present we are using the resourceAttributes variable in the ResourceMap file for positive choice generation and this file currently just need a common entry. In future when we switch to negative choice, i.e. all elements except, then this will become important.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdIgnoreElements } from "../../types/OcdImporterData";

export const ignoreElements: OcdIgnoreElements = {
    "common": [
        "id",
        "tags"
    ]
}
```

#### src/generator/GoogleMarkdownGenerator.ts
The &lt;Provider&gt;MarkdownGenerator.ts extends the common OcdMarkdownGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdMarkdownGenerator } from './OcdMarkdownGenerator'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GoogleMarkdownGenerator extends OcdMarkdownGenerator {
    constructor () {
        super('Google')
        this.ignoreAttributes = [...commonElements, ...commonIgnoreElements]
    }
}

export default GoogleMarkdownGenerator
// module.exports = { GoogleMarkdownGenerator }
```

#### src/generator/GoogleModelGenerator.ts
The &lt;Provider&gt;ModelGenerator.ts extends the common OcdModelGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdModelGenerator } from './OcdModelGenerator'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GoogleModelGenerator extends OcdModelGenerator {
    constructor () {
        super('Google')
        this.ignoreAttributes = [...commonElements, ...commonIgnoreElements]
    }
}

export default GoogleModelGenerator
// module.exports = { GoogleModelGenerator }
```

#### src/generator/GooglePropertiesGenerator.ts
The &lt;Provider&gt;PropertiesGenerator.ts extends the common OcdPropertiesGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdPropertiesGenerator } from './OcdPropertiesGenerator'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GooglePropertiesGenerator extends OcdPropertiesGenerator {
    constructor () {
        super('Google')
        this.ignoreAttributes = [...commonElements, ...commonIgnoreElements]
    }
}

export default GooglePropertiesGenerator
// module.exports = { GooglePropertiesGenerator }
```

#### src/generator/GoogleTabularGenerator.ts
The &lt;Provider&gt;TabularGenerator.ts extends the common OcdTabularGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdTabularGenerator } from './OcdTabularGenerator'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GoogleTabularGenerator extends OcdTabularGenerator {
    constructor () {
        super('Google')
        this.ignoreAttributes = [...commonElements, ...commonIgnoreElements]
    }
}

export default GoogleTabularGenerator
// module.exports = { GoogleTabularGenerator }
```

#### src/generator/GoogleTerraformGenerator.ts
The &lt;Provider&gt;TerraformGenerator.ts extends the common OcdTerraformGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdTerraformGenerator } from './OcdTerraformGenerator'
import { terraformMetadataOverrides } from './data/GoogleMetadataOverrides'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GoogleTerraformGenerator extends OcdTerraformGenerator {
    constructor () {
        super('Google', commonElements, commonIgnoreElements)
        this.terraformMetadataOverrides = terraformMetadataOverrides
    }

}

export default GoogleTerraformGenerator
// module.exports = { GoogleTerraformGenerator }
```

#### src/generator/GoogleValidatorGenerator.ts
The &lt;Provider&gt;ValidatorGenerator.ts extends the common OcdValidatorGenerator.ts configuring the Provider (Google). It imports the Provider (Goggle) specific mapping and element information from the **data/&lt;Provider&gt;CommonResourceProperties.ts** add **data/&lt;Provider&gt;MetadataOverides.ts**, files and passes them to the common generator.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdValidatorGenerator } from './OcdValidatorGenerator'
import { commonElements, commonIgnoreElements } from './data/GoogleCommonResourceProperties'

export class GoogleValidatorGenerator extends OcdValidatorGenerator {
    constructor () {
        super('Google')
        this.ignoreAttributes = [...commonElements, ...commonIgnoreElements]
    }
}

export default GoogleValidatorGenerator
// module.exports = { GoogleValidatorGenerator }
```

#### src/generator/data/GoogleCommonResourceProperties.ts
The **&lt;Provider&gt;CommonResourceProperties.ts** exports two constants that specify common elements used within the properties sheet and hence should be ignored because they will be display in a common section. In addition athe commonIgnoreElements specifies additions elements that will be ignored for the properties sheet generation.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

export const commonElements = [
    'parent_id',      // Common Element
    'tags',           // Common Element
    'display_name',   // Common Element
    'id',             // Common Element
    'name',           // Common Element
]
export const commonIgnoreElements = [
    'location',
    'type'
]
```

#### src/generator/data/GoogleMetadataOverrides.ts
The **&lt;Provider&gt;MetadataOverrides.ts** exports a single constant terraformMetadataOverrides that will be used during the terraform generation to modify the standard generated code.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

export const terraformMetadataOverrides = {
    "common": {
    }
}
```

### ocd/packages/codegen-cli
The codegen-cli will simply use the Classes created in the "codegen" package and so we will only need to do a few simple changes to enable the cli.

#### src/ocd-codegen.ts
Add the following conditions to the 'generate' command section
```typescript
else if (subcommand.toLocaleLowerCase() === 'google-model-js') generator = new GoogleModelGenerator()
else if (subcommand.toLocaleLowerCase() === 'google-markdown-js') generator = new GoogleMarkdownGenerator()
else if (subcommand.toLocaleLowerCase() === 'google-properties-js') generator = new GooglePropertiesGenerator()
else if (subcommand.toLocaleLowerCase() === 'google-terraform-js') generator = new GoogleTerraformGenerator()
else if (subcommand.toLocaleLowerCase() === 'google-tabular-js') generator = new GoogleTabularGenerator()
else if (subcommand.toLocaleLowerCase() === 'google-validator-js') generator = new GoogleValidatorGenerator()
```

Add the following to the 'import' command section.

```typescript
else if (subcommand.toLocaleLowerCase() === 'google-terraform-schema') importer = new GoogleTerraformSchemaImporter()
```

#### package.json

Add the following entries to the script section of the package.json file.
```json
"generate-google-terraform-provider-schema": "cd schema/google && terraform init -upgrade && terraform providers schema -json > tf-schema.json",

"import-google-terraform-schema": "node lib/esm/ocd-codegen.js import google-terraform-schema -i ./schema/google/tf-schema.json -o ./schema/google-schema.json",

"generate-google-markdown":       "node lib/esm/ocd-codegen.js generate google-markdown-js   -s ./schema/google-schema.json -d ../export/src/markdown/provider/google",
"generate-google-model":          "node lib/esm/ocd-codegen.js generate google-model-js      -s ./schema/google-schema.json -d ../model/src/provider/google",
"generate-google-properties":     "node lib/esm/ocd-codegen.js generate google-properties-js -s ./schema/google-schema.json -d ../desktop/src/components/properties/provider/google",
"generate-google-tabular":        "node lib/esm/ocd-codegen.js generate google-tabular-js    -s ./schema/google-schema.json -d ../desktop/src/components/tabular/provider/google",
"generate-google-terraform":      "node lib/esm/ocd-codegen.js generate google-terraform-js  -s ./schema/google-schema.json -d ../export/src/terraform/provider/google",
"generate-google-validator":      "node lib/esm/ocd-codegen.js generate google-validator-js  -s ./schema/google-schema.json -d ../model/src/validator/provider/google",
"generate-google":                "npm run generate-google-model && npm run generate-google-markdown && npm run generate-google-properties && npm run generate-google-terraform && npm run generate-google-tabular && npm run generate-google-validator",

"import-and-generate-google":     "npm run import-google-terraform-schema && npm run generate-google",

```

Update the following script entries to include the new Provider specific scripts
```json
"generate": "npm run generate-oci && npm run generate-azurerm && npm run generate-google",
"import-and-generate": "npm run import-and-generate-oci && npm run import-and-generate-azurerm && npm run import-and-generate-google"
```

## Provider Specific Code
Although the Code Generation will create the majority of the code required for implementing a new Provider some additional modifications and code will need to be written. The following shows the additional functionaly required to implement the new (Google) provider.
### ocd/packages/model
#### src/provider/google/GoogleResource.ts
The **&lt;Provider&gt;Resource** Namespace provides the Provider specific implementation of the standard Model functions:

- newResource
- cloneResource
- assignParentId
- getParentId
- getAssociationIds

It will be inheritted from by all generated Resource files and provides the key Provider specific identification.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/


import { v4 as uuidv4 } from 'uuid'
import { OcdUtils } from '@ocd/core'
import { OcdResource } from "../../OcdResource"
import * as Resources from './resources'
import { OcdResources } from '../../OcdDesign'

export interface GoogleResource extends OcdResource {
    location: string
    parentId: string
    displayName?: string
}


export namespace GoogleResource {
    export function uuid(prefix: string) {return `okit.${prefix}.${uuidv4()}`}
    export function newResource(type: string): GoogleResource {
        const displayName = `${OcdUtils.toTitleCase(type ? type.split('_').join(' ') : 'Unknown')} ${uuidv4().slice(-4)}`
        return {
            ...OcdResource.newResource(type),
            provider: 'google',
            location: '',
            parentId: '',
            id: GoogleResource.uuid(type),
            displayName: `${displayName}`,
            documentation: ''
        }
    }
    export function cloneResource(resource: GoogleResource, type: string): GoogleResource {
        const displayName = `${resource.displayName} Clone`
        const id = GoogleResource.uuid(type)
        let clone = OcdResource.cloneResource(resource, type)
        clone.displayName = displayName
        clone.id = id
        return clone
    }
    export function assignParentId(child: GoogleResource, parent: GoogleResource) {
        const namespace = `Google${child.resourceType}`
        // @ts-ignore 
        const allowedParentTypes = Resources[namespace].allowedParentTypes()
        if (allowedParentTypes.includes(parent.resourceType) && getParentId(child) !== parent.id) {
            // @ts-ignore 
            Resources[namespace].setParentId(child, parent.id)
        }
    }
    export function getParentId(resource: GoogleResource, allResources?: OcdResources): string {
        const namespace = `Google${resource.resourceType}`
        // @ts-ignore 
        const parentId = Resources[namespace].getParentId(resource, allResources)
        return parentId
    }
    export function getAssociationIds(resource: GoogleResource, allResources: OcdResources): string[] {
        const namespace = `Google${resource.resourceType}`
        // @ts-ignore 
        const associationIds = Resources[namespace].getConnectionIds(resource, allResources)
        return associationIds
    }
}
```

#### src/OcdDesign.ts
The **OcdDesign** Namespace will need to extended to implement Provider specific functions, whilst the high level functions will need to be modified to include calls to the new Provider specific functions. The following excepts of code will show hos this is done for out Google example.

##### Add New Interfaces
```typescript
export interface GoogleResources {
    [key: string]: any[]
}
```
```typescript
export interface GoogleModel extends OcdBaseModel {}
```
##### Modify Model Element
```typescript
export interface OcdDesign {
    metadata: OcdMetadata
    model: {
        oci: OciModel
        aws?: AwsModel
        azure: AzureModel
        google: GoogleModel
        general: GeneralModel
    },
    view: OcdView,
    userDefined: OcdUserDefined
}
```
##### Add and Update Resource Functions
```typescript
// Model Methods
export function getResourceLists(design: OcdDesign) {return {...getOciResourceLists(design), ...getAzureResourceLists(design), ...getGoogleResourceLists(design), ...getGeneralResourceLists(design)}}
export function getResources(design: OcdDesign) {return [...getOciResources(design), ...getAzureResources(design), ...getGoogleResources(design), ...getGeneralResources(design)]}
```
```typescript
// Google
export function getGoogleResourceLists(design: OcdDesign) {return Object.hasOwn(design.model, 'google') ? design.model.google.resources : {}}
export function getGoogleResourceList(design: OcdDesign, key: string) {return Object.hasOwn(design.model, 'google') && Object.hasOwn(design.model.google.resources, key) ? design.model.google.resources[key] : []}
export function getGoogleResources(design: OcdDesign) {return Object.hasOwn(design.model, 'google') ? Object.values(design.model.google.resources).filter((val) => Array.isArray(val)).reduce((a, v) => [...a, ...v], []) : []}
```

#### src/index.ts
The new Resource specific Namespaces, Interfaces and Classes will need to be added to the index.ts file as exports to make them available to the other packages.

```typescript
// Google
export { GoogleResources } from './OcdDesign'
export { GoogleResource } from './provider/google/GoogleResource'
export * as GoogleModelResources from './provider/google/resources'
export * as GoogleResourceValidation from './validator/provider/google/resources'
```

### ocd/packages/desktop
#### src/components/OcdDocument.ts
##### imports
Update imports from the @ocd/model to include the new Provider specific Namespaces, Interfaces and Classes.

```typescript
import { OcdAutoLayout, OcdDesign, OcdViewPage, OcdViewCoords, OcdViewLayer, OcdBaseModel, OcdViewPoint, OcdViewCoordsStyle, OcdResource, PaletteResource, 
    OciModelResources, OciResource,
    AzureModelResources, AzureResource, 
    GoogleModelResources, GoogleResource,
    GeneralModelResources, GeneralResource } from '@ocd/model'
```

##### Functions
Add Provider specific functions as shown in the extract below.

```typescript
getGoogleResourcesObject() {return this.design.model.google.resources}

addGoogleReasourceToList(key: string, modelResource: GoogleResource) {
    if (!Object.hasOwn(this.design.model, 'google')) this.design.model.google = {resources: {}, vars: []}
    if (!Object.hasOwn(this.design.model.google.resources, key)) this.design.model.google.resources[key] = []
    this.design.model.google.resources[key].push(modelResource)
}

addGoogleResource(paletteResource: PaletteResource, compartmentId: string): OcdAddResourceResponse {
    const resourceList = paletteResource.class.split('-').slice(1).join('_')
    const resourceClass = paletteResource.class.toLowerCase().split('-').map((w) => `${w.charAt(0).toUpperCase()}${w.slice(1)}`).join('')
    const resourceNamespace: string = `${resourceClass}`
    // @ts-ignore 
    const client = GoogleModelResources[resourceNamespace]
    console.debug('OcdDocument: Namespace',resourceNamespace , client)
    if (client) {
        const modelResource = client.newResource()
        modelResource.compartmentId = compartmentId
        console.debug('OcdDocument:', modelResource)
        this.addGoogleReasourceToList(resourceList, modelResource)
        const response: OcdAddResourceResponse = {modelResource: modelResource, additionalResources: []}
        const additionalResources = client.getAdditionalResources?.() // Use Optional Chaining to test if function exists
        if (additionalResources) {
            console.debug('OcdDocument: Creating Google Additional Resources', additionalResources)
            additionalResources.forEach((r: PaletteResource) => {
                const additionalResource = this.addGoogleResource(r, compartmentId).modelResource
                if (additionalResource) {
                    response.additionalResources.push(additionalResource)
                    this.setResourceParent(additionalResource.id, modelResource.id)
                    client.setAdditionalResourceValues?.(modelResource, additionalResource)
                }
            })
        }
        return response
    } else {
        alert(`Google Resource ${resourceClass} has not yet been implemented.`)
        return {modelResource: undefined, additionalResources: []}
    }
}
```

Update highlevel function to test for new Provider as shown in the extract below.

```typescript
addResource(paletteResource: PaletteResource, compartmentId: string): OcdAddResourceResponse {
    switch(paletteResource.provider) {
        case 'oci':
            return this.addOciResource(paletteResource, compartmentId)
        case 'azure':
            return this.addAzureResource(paletteResource, compartmentId)
        case 'google':
            return this.addGoogleResource(paletteResource, compartmentId)
        case 'general':
            return this.addGeneralResource(paletteResource, compartmentId)
        default:
            alert(`Provider ${paletteResource.provider} has not yet been implemented.`)
            return {modelResource: undefined, additionalResources: []}
    }
}
```

#### src/components/OcdProperties.tsx
##### imports
Update imports from the @ocd/model to include the new Provider specific Namespaces, Interfaces and Classes.

```typescript
import { AzureResources, OcdDesign, OcdResource, OcdVariable, OcdViewCoordsStyle, OcdViewPage, OciDefinedTag, OciFreeformTag, OciResourceValidation, OciResources, OcdValidationResult, GoogleResources } from '@ocd/model'
import * as googleResources from './properties/provider/google/resources'
```

##### Resource Proxy 
Add Provider (Google) specific function to get the Resources proxy from the generated set of proxies.

```typescript
const getGoogleResourceProxy = (ocdDocument: OcdDocument, selectedModelResource: OcdResource, ocdCache: OcdCacheData) => {
    const provider = selectedModelResource.provider
    const resourceType = selectedModelResource.resourceType
    const resourceProxyName = `${OcdUtils.toTitleCase(provider)}${resourceType}Proxy`
    console.debug(`> OcdProperies: OcdResourceProperties: Render(GoogleProxy(${resourceProxyName}))`, selectedModelResource)
    //@ts-ignore
    return Object.hasOwn(googleResources, resourceProxyName) ? googleResources[resourceProxyName].proxyResource(ocdDocument, selectedModelResource, ocdCache) : selectedModelResource
}
```

Update the common **getSelectedResourceProxy** to check for the new provider(google) and call the provider specific function.

```typescript
const getSelectedResourceProxy = (ocdDocument: OcdDocument, selectedModelResource: OcdResource, ocdCache: OcdCacheData) => {    
    const provider = selectedModelResource ? selectedModelResource.provider : ''
    console.debug('OcdProperties: getSelectedResourceProxy:', selectedModelResource)
    switch (provider) {
        case 'azure':
            return getAzureResourceProxy(ocdDocument, selectedModelResource, ocdCache)
        case 'google':
            return getGoogleResourceProxy(ocdDocument, selectedModelResource, ocdCache)
        case 'oci':
            return getOciResourceProxy(ocdDocument, selectedModelResource, ocdCache)
        default:
            return selectedModelResource
    }
}
```

##### Resource Properties
Update the **getResourceProperties** to check for the new provider (google) and return the Resource Namespace for the appropriate imported resources.

```typescript
const getResourceProperties = (selectedModelResource: OcdResource) => {
    const provider = selectedModelResource ? selectedModelResource.provider : ''
    const resourceType = selectedModelResource ? selectedModelResource.resourceType : ''
    const resourceJSXMethod = `${OcdUtils.toTitleCase(provider)}${resourceType}`
    console.debug(`> OcdProperies: OcdResourceProperties: Render(JMX(${resourceJSXMethod}))`)
    switch (provider) {
        case 'azure':
            // @ts-ignore 
            return azureResources[resourceJSXMethod]
        case 'google':
            // @ts-ignore 
            return googleResources[resourceJSXMethod]
        case 'oci':
            // @ts-ignore 
            return ociResources[resourceJSXMethod]
        default:
            return undefined
    }
}
```

##### Resource Validation
Add Provider (Google) specific function to get the Resources Validation class from the generated set of validation classes.

```typescript
const getGoogleResourceValidationResults = (ocdDocument: OcdDocument, selectedModelResource: OcdResource): OcdValidationResult[] => {
    const googleResources: GoogleResources = ocdDocument.getGoogleResourcesObject()
    // @ts-ignore 
    const ResourceValidation = GoogleResourceValidation[resourceValidationMethod(selectedModelResource)]
    const validationResults = ResourceValidation ? ResourceValidation.validateResource(selectedModelResource, googleResources) : []
    return validationResults
}

```

Update the **getResourceValidationResults** to check for the new provider (google) and return the Resource specific function.

```typescript
const getResourceValidationResults = (ocdDocument: OcdDocument, selectedModelResource: OcdResource): OcdValidationResult[] => {
    const provider = selectedModelResource ? selectedModelResource.provider : ''
    switch (provider) {
        case 'azure': 
            return getAzureResourceValidationResults(ocdDocument, selectedModelResource)
        case 'google': 
            return getGoogleResourceValidationResults(ocdDocument, selectedModelResource)
        case 'oci': 
            return getOciResourceValidationResults(ocdDocument, selectedModelResource)
        default:
            return []
    }
}
```

#### src/components/properties/provider/google/GoogleCommonConfigs.ts
The **&lt;Provider&gt;CommonConfigs.ts** file contains the config definitions for fields that are common across the Provider. This extends the overall OcdCommonConfigs and each resource within the Provider will extend this with there custom configurations.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { ResourceElementConfig } from "../../OcdPropertyTypes";
import { OcdCommonConfigs } from "../../OcdCommonConfigs";

export namespace GoogleCommonConfigs {
    export function configs(): ResourceElementConfig[] {
        return [
            ...OcdCommonConfigs.configs(),
            {
                id: 'admin_password',
                properties: {
                    pattern: '^var\.+$',
                    title: 'Password fields only support Variables.'
                },
                configs: []
            },
        ]
    }
}
```

#### src/css/google-theme.css
This css file specifies the Provider design theme style sheets. Each resource will be specified in the form **.google-compute-network** where :
- google: The Provider
- compute-network: Resource list name with "_" replaced by "-"
```css
/* Copyright (c) 2020, Oracle and/or its affiliates. All rights reserved. */
/* Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl. */

/*
** Groups
*/
.google-cloud {
    background-image: url("Removed to reduce document size");
}

.google-compute {
    background-image: url("Removed to reduce document size");
}

.google-container {
    background-image: url("Removed to reduce document size");
}

.google-database {
    background-image: url("Removed to reduce document size");
}

.google-hamburger {
    background-image: url("Removed to reduce document size");
}

.google-network {
    background-image: url("Removed to reduce document size");
}

.google-refresh {
    background-image: url("Removed to reduce document size");
}

.google-storage {
    background-image: url("Removed to reduce document size");
}

/*
** Resources
*/
.google-compute-network {
    background-image: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PGRlZnM+PHN0eWxlPi5wcmVmaXhfX2Nscy0xe2ZpbGw6I2FlY2JmYX0ucHJlZml4X19jbHMtMntmaWxsOiM2NjlkZjZ9LnByZWZpeF9fY2xzLTN7ZmlsbDojNDI4NWY0fTwvc3R5bGU+PC9kZWZzPjxnIGRhdGEtbmFtZT0iUHJvZHVjdCBJY29ucyI+PHBhdGggY2xhc3M9InByZWZpeF9fY2xzLTEiIGQ9Ik0xNiAyaDZ2NmgtNnoiLz48cGF0aCBjbGFzcz0icHJlZml4X19jbHMtMiIgZD0iTTE5IDJoM3Y2aC0zeiIvPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0xIiBkPSJNMTYgMTZoNnY2aC02eiIvPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0yIiBkPSJNMTkgMTZoM3Y2aC0zeiIvPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0xIiBkPSJNMiAyaDZ2NkgyeiIvPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0yIiBkPSJNNSAyaDN2Nkg1eiIvPjxwYXRoIGNsYXNzPSJwcmVmaXhfX2Nscy0xIiBkPSJNMiAxNmg2djZIMnoiLz48cGF0aCBjbGFzcz0icHJlZml4X19jbHMtMiIgZD0iTTUgMTZoM3Y2SDV6TTggNGg4djJIOHpNOCAxOGg4djJIOHpNMTggOGgydjhoLTJ6TTQgOGgydjhINHoiLz48cGF0aCBjbGFzcz0icHJlZml4X19jbHMtMyIgZD0iTTQgOGgydjJINHpNMTggOGgydjJoLTJ6TTggNGgydjJIOHpNOCAxOGgydjJIOHoiLz48L2c+PC9zdmc+");
}

.google-virtual-private-cloud {
    background-image: url("Removed to reduce document size");
}

.google-oracle-autonomous-database, .google-oracledatabase-autonomous-database-regular {
    background-image: url("Removed to reduce document size");
}

.google-oracle-exadata-database, .google-oracledatabase-exadata-infrastructure {
    background-image: url("Removed to reduce document size");
}

.google-oracledatabase-cloud-vm-cluster {
    background-image: url("Removed to reduce document size");
}
```

### ocd/packages/export
#### src/OcdExporter.ts
Update the **OcdExporter.ts** to include a new Provider (Google) specific function to get the Provider Resources.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdDesign } from "@ocd/model";
import { OcdUtils } from "@ocd/core";

export interface OutputDataString extends Record<string, string> {}
export interface OutputDataStringArray extends Record<string, string[]> {}

class OcdExporter {
    design: OcdDesign
    constructor() {
        this.design = OcdDesign.newDesign()
    }

    getOciResources() {return OcdDesign.getOciResources(this.design)}
    getAzureResources() {return OcdDesign.getAzureResources(this.design)}
    getGoogleResources() {return OcdDesign.getGoogleResources(this.design)}
    getResources() {return OcdDesign.getResources(this.design)}

    export = (design: OcdDesign): string | OutputDataStringArray | OutputDataString => ''

    toTitleCase = (str: string) => OcdUtils.toTitleCase(str)
    toCamelCase = (str: string) => OcdUtils.toCamelCase(str)
    toUnderscoreCase = (str: string) => OcdUtils.toUnderscoreCase(str)
}

export default OcdExporter
export { OcdExporter }
```

#### src/markdown/provider/google/GoogleMarkdownResource.ts

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import OcdMarkdownResource from '../../OcdMarkdownResource'
import { GoogleModelResources as Model, GoogleResource } from '@ocd/model'

export class GoogleMarkdownResource extends OcdMarkdownResource {
    googleCommonGeneration = (resource: GoogleResource): string => {
        return `#### ${resource.displayName}

${this.ocdCommonGeneration(resource)}
`
    }
}

export default GoogleMarkdownResource
```

#### src/terraform/provider/google/GoogleTerraformResource.ts
The **&lt;Provider&gt;TerraformResource.ts providers the core Provider terraform resource that all generated resource are inherited from. This class has a number of functions that generated comman assignment statements and associated tagging information, as such the individual generated resources do not need to implement these.

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import OcdTerraformResource from "../../OcdTerraformResource"
import { OcdDesign, GoogleResource } from '@ocd/model'

export class GoogleTerraformResource extends OcdTerraformResource {
    isHomeRegion: boolean
    simpleCacheAttributes = []
    lookupCacheAttributes = []
    constructor(idTFResourceMap={}, isHomeRegion: boolean = false) {
        super(idTFResourceMap)
        this.isHomeRegion = isHomeRegion
    }

    commonAssignments = (resource: GoogleResource) => {
        return ``
    }

    tags = (resource: GoogleResource, design: OcdDesign): string => {
        return `# Tags`
    }

    generateAdditionalResourceLocals(resource: GoogleResource) {
        return ''
    }
    generateAdditionalResource(resource: GoogleResource) {
        return ''
    }
}
```

#### src/terraform/GoogleExporter.ts
The **&lt;Provider&gt;Exporter.ts** generates the Provider specific Terraform functionality; such as terraform provider details, terraform meta data and connection variables. This is is then mapped to the appropriate Provider files as defined in the **resourceFileMap** variable.  

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdDesign } from "@ocd/model"
import { OcdProviderExporter } from "./OcdProviderExporter"
import { OutputDataStringArray } from "../OcdExporter"
import { OcdUtils } from "@ocd/core"
import * as GoogleTerraformResources  from './provider/google/resources'

interface ResourceMap extends Record<string, string> {}

export class GoogleExporter extends OcdProviderExporter {
    terraform: string = ''
    resourceFileMap: ResourceMap = {
        compute_network: "google_networking.tf",

        unknown: "google_unspecified.tf"
    }
    // Google Methods
    export = (design: OcdDesign): OutputDataStringArray => {
        // Id to Terraform Resource Name Map
        const idTFResourceMap: Record<string, string> = OcdDesign.getGoogleResources(design).reduce((a, c) => {a[c.id] = c.terraformResourceName; return a}, {} as Record<string, string>)
        console.debug('GoogleExporter: export: idTFResourceMap:', idTFResourceMap)
        let outputData: OutputDataStringArray = {}
        if (Object.keys(idTFResourceMap).length > 0) {
            const uniqueFilenames = [...new Set(Object.values(this.resourceFileMap))]
            outputData = {
                "google_provider.tf": [this.googleProvider()],
                "google_provider_variables.tf": [this.googleProviderVariables()],
                "google_connection.tfvars": [this.googleProviderTFVars()],
                "google_metadata.tf": [this.googleMetadata()],
                ...uniqueFilenames.sort(OcdUtils.simpleSort).reduce((a, c) => {a[c] = [this.autoGeneratedNotice()]; return a}, {} as Record<string, string[]>),
                "google_user_variables.tf": [this.googleUserVariables(design)],
            }
            // Generate Google Terraform
            Object.entries(design.model.google.resources).forEach(([k, v]) => {
                const className = OcdUtils.toClassName('Google', k)
                const filename = this.resourceFileMap.hasOwnProperty(k) ? this.resourceFileMap[k] : this.resourceFileMap['unknown']
                // @ts-ignore
                v.forEach((r: OciResource) => {
                    // @ts-ignore 
                    const tfResource = new GoogleTerraformResources[className](r, idTFResourceMap)
                    if (!outputData.hasOwnProperty(filename)) outputData[filename] = [this.autoGeneratedNotice()]
                    outputData[filename].push(tfResource.generate(r, design))
                })
            })
        }
        return outputData
    }
    googleProvider = () => {return `${this.autoGeneratedNotice()}
terraform {
    required_version = ">= 1.5.0"
}

# ------ Configure the Google GCP Provider
provider "google" {
  project     = var.google_project_id
  region      = var.google_region
}`
    }
    googleProviderVariables = () => {return `${this.autoGeneratedNotice()}`}
    googleProviderTFVars = (useConfig: boolean = false) => {return `${this.autoGeneratedNotice()}`}
    googleMetadata = () => {return `${this.autoGeneratedNotice()}`}
    googleUserVariables = (design: OcdDesign) => {return `${this.autoGeneratedNotice()}
${design.model.google.vars.map((v) => this.variableStatement(v)).join('')}
    `}
}
```

#### src/terraform/OcdTerraformExporter.ts
Update the **OcdTerraformExporter.ts** to include a new Provider (Google) specific Exporter Object and call export..

```typescript
/*
** Copyright (c) 2020, 2024, Oracle and/or its affiliates.
** Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.
*/

import { OcdDesign, OcdVariable, OciResource } from "@ocd/model"
import { OcdExporter, OutputDataStringArray } from "../OcdExporter"
import { OciExporter } from "./OciExporter"
import { AzureExporter } from "./AzureExporter"
import { GoogleExporter } from "./GoogleExporter"

interface ResourceMap extends Record<string, Record<string, string>> {}

export class OcdTerraformExporter extends OcdExporter {
    export = (design: OcdDesign): OutputDataStringArray => {
        this.design = design
        const ociExporter = new OciExporter()
        const azureExporter = new AzureExporter()
        const googleExporter = new GoogleExporter()
        const outputData: OutputDataStringArray = {
            ...ociExporter.export(design),
            ...azureExporter.export(design),
            ...googleExporter.export(design),
        }
        const allResources: string[] = Object.values(outputData).reduce((a, c) => [...a, ...c], [])
        this.terraform = allResources.join('\n')
        return outputData
    }
}

export default OcdTerraformExporter
```
